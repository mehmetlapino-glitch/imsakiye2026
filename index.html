<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Ä°msakiye Pro 2026</title>
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" href="favicon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ä°msakiye">
    <meta name="application-name" content="Ä°msakiye">

    <style>
        :root {
            --bg: #f8fafc; --card: #ffffff; --text: #1e293b;
            --primary: #2563eb; --accent: #10b981; --highlight: #f59e0b;
            --input-bg: #f1f5f9; --input-border: #e2e8f0;
            --logo-light: block; --logo-dark: none;
        }
        [data-theme="dark"] {
            --bg: #0f172a; --card: #1e293b; --text: #f8fafc;
            --primary: #38bdf8; --accent: #2dd4bf; --highlight: #fbbf24;
            --input-bg: #334155; --input-border: #475569;
            --logo-light: none; --logo-dark: block;
        }

        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 15px; transition: 0.3s; box-sizing: border-box; }
        .card { background: var(--card); width: 100%; max-width: 450px; padding: 25px; border-radius: 24px; box-shadow: 0 20px 50px rgba(0,0,0,0.1); text-align: center; position: relative; }
        
        .logo-container { width: 100%; margin-bottom: 20px; display: flex; justify-content: center; align-items: center; }
        .logo-container img { max-width: 100%; height: auto; border-radius: 1px; margin: 0 auto; }
        #logo-light { display: var(--logo-light); }
        #logo-dark { display: var(--logo-dark); }

        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .theme-toggle { cursor: pointer; font-size: 1.3rem; background: none; border: none; color: var(--text); }
        .lang-btn { background: var(--input-bg); border: none; color: var(--text); padding: 5px 10px; border-radius: 6px; cursor: pointer; font-size: 0.75rem; font-weight: bold; }
        .lang-btn.active { background: var(--primary); color: white; }

        .date-time-bar { display: flex; justify-content: space-between; align-items: center; background: var(--input-bg); border-radius: 14px; padding: 10px 16px; margin-bottom: 8px; }
        .miladi-date { font-size: 0.82rem; color: var(--text); font-weight: 600; }
        .real-clock { font-size: 1.1rem; font-weight: 800; color: var(--primary); font-variant-numeric: tabular-nums; letter-spacing: 1px; }
        .hicri-date { font-size: 0.82rem; color: var(--accent); font-weight: bold; margin-bottom: 5px; text-align: center; }
        #display-city { margin: 5px 0 15px 0; font-size: 1.4rem; font-weight: 800; color: var(--primary); text-transform: uppercase; }

        .search-container { position: relative; margin-bottom: 20px; }
        .search-box { display: flex; gap: 8px; }
        input { flex: 1; background: var(--input-bg); border: 1px solid var(--input-border); padding: 12px; border-radius: 12px; color: var(--text); outline: none; }
        .suggestions { position: absolute; top: 100%; left: 0; right: 0; background: var(--card); border: 1px solid var(--input-border); z-index: 100; border-radius: 12px; display: none; text-align: left; max-height: 180px; overflow-y: auto; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .s-item { padding: 12px; cursor: pointer; border-bottom: 1px solid var(--input-border); font-size: 0.85rem; }

        #timer { font-size: 3.2rem; font-weight: 800; color: var(--primary); font-variant-numeric: tabular-nums; margin: 5px 0; }
        #countdown-label { font-size: 0.8rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; }
        .progress-container { background: var(--input-bg); height: 8px; border-radius: 4px; overflow: hidden; margin: 15px 0; }
        .progress-fill { background: linear-gradient(90deg, var(--primary), var(--accent)); width: 0%; height: 100%; transition: width 1s linear; }

        .vakit-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .vakit-item { background: var(--input-bg); padding: 15px; border-radius: 18px; border-bottom: 4px solid var(--accent); }
        .vakit-time { font-size: 1.6rem; font-weight: bold; }

        .tool-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .tool-btn { background: var(--input-bg); border: 1px solid var(--input-border); color: var(--text); padding: 12px; border-radius: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 0.85rem; }

        .hadith-area { background: rgba(245, 158, 11, 0.05); border: 1px solid rgba(245, 158, 11, 0.3); padding: 20px; border-radius: 18px; text-align: left; }
        #hadith-narrator { font-style: italic; color: #94a3b8; margin-top: 12px; font-size: 0.85rem; text-align: right; }

        /* KÄ±ble PusulasÄ± Modal */
        #qibla-modal {
            display: none; position: fixed; inset: 0;
            background: rgba(0,0,0,0.7); backdrop-filter: blur(6px);
            z-index: 999; justify-content: center; align-items: center;
        }
        #qibla-modal.open { display: flex; }
        .qibla-box {
            background: var(--card); border-radius: 28px; padding: 30px 24px 24px;
            text-align: center; width: 320px; max-width: 90vw;
            box-shadow: 0 30px 60px rgba(0,0,0,0.3);
        }
        .qibla-box h3 { margin: 0 0 6px; color: var(--primary); font-size: 1.2rem; }
        .qibla-box .sub { font-size: 0.75rem; color: #94a3b8; margin-bottom: 20px; }
        .compass-wrap {
            position: relative; width: 220px; height: 220px;
            margin: 0 auto 20px; user-select: none;
        }
        #compass-ring {
            width: 220px; height: 220px; border-radius: 50%;
            background: conic-gradient(
                #1e293b 0deg, #334155 90deg, #1e293b 180deg, #334155 270deg, #1e293b 360deg
            );
            border: 3px solid var(--input-border);
            position: absolute; top: 0; left: 0;
            display: flex; align-items: center; justify-content: center;
            transition: transform 0.15s ease-out;
        }
        [data-theme="dark"] #compass-ring {
            background: conic-gradient(
                #0f172a 0deg, #1e293b 90deg, #0f172a 180deg, #1e293b 270deg, #0f172a 360deg
            );
        }
        .compass-letters {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            pointer-events: none;
        }
        .compass-letters span {
            position: absolute; font-size: 0.75rem; font-weight: bold;
            color: #94a3b8; left: 50%; transform: translateX(-50%);
        }
        .compass-letters .cn { top: 8px; color: #ef4444; }
        .compass-letters .cs { bottom: 8px; }
        .compass-letters .ce { right: 8px; left: auto; transform: none; top: 50%; margin-top: -8px; }
        .compass-letters .cw { left: 8px; transform: none; top: 50%; margin-top: -8px; }

        #north-needle {
            position: absolute; top: 50%; left: 50%;
            width: 6px; height: 80px;
            transform-origin: bottom center;
            transform: translateX(-50%) translateY(-100%);
            border-radius: 3px 3px 0 0;
            background: linear-gradient(to top, transparent 0%, #ef4444 40%, #ef4444 100%);
            pointer-events: none;
        }
        #south-needle {
            position: absolute; top: 50%; left: 50%;
            width: 6px; height: 80px;
            transform-origin: top center;
            transform: translateX(-50%);
            border-radius: 0 0 3px 3px;
            background: linear-gradient(to bottom, transparent 0%, #94a3b8 40%, #94a3b8 100%);
            pointer-events: none;
        }

        #qibla-arrow {
            position: absolute; top: 50%; left: 50%;
            width: 0; height: 0;
            transform-origin: center bottom;
            transform: translateX(-50%) translateY(-100%) rotate(0deg);
            transition: transform 0.3s ease;
            pointer-events: none;
        }
        #qibla-arrow::before {
            content: '';
            position: absolute;
            left: -12px; top: -90px;
            width: 0; height: 0;
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-bottom: 80px solid #10b981;
            filter: drop-shadow(0 0 8px #10b981aa);
        }
        #qibla-arrow::after {
            content: 'ğŸ•‹';
            position: absolute;
            font-size: 18px;
            left: -10px; top: -112px;
        }

        .compass-center {
            position: absolute; top: 50%; left: 50%;
            width: 14px; height: 14px; border-radius: 50%;
            background: var(--primary);
            transform: translate(-50%, -50%);
            z-index: 10;
            box-shadow: 0 0 10px var(--primary);
        }

        .qibla-degree {
            font-size: 2rem; font-weight: 800; color: var(--primary);
            margin-bottom: 4px;
        }
        .qibla-status {
            font-size: 0.8rem; margin-bottom: 16px;
            padding: 6px 14px; border-radius: 20px;
            background: var(--input-bg); display: inline-block;
        }
        .qibla-status.locked { background: rgba(16,185,129,0.15); color: #10b981; }
        .qibla-status.searching { color: #f59e0b; background: rgba(245,158,11,0.1); }
        #qibla-close {
            background: var(--input-bg); border: none; color: var(--text);
            padding: 10px 28px; border-radius: 12px; cursor: pointer;
            font-size: 0.9rem; font-weight: 600;
        }

        /* ====================== Ä°LK AÃ‡ILIÅ POPUP MODALI ====================== */
        #install-modal {
            display: none; position: fixed; inset: 0;
            background: rgba(0,0,0,0.75); backdrop-filter: blur(10px);
            z-index: 10000; justify-content: center; align-items: center;
        }
        #install-modal.show { display: flex; }
        .install-box {
            background: var(--card); border-radius: 28px; padding: 28px 22px 22px;
            text-align: center; width: 310px; max-width: 90vw;
            box-shadow: 0 30px 70px rgba(0,0,0,0.35);
        }
        .install-box h2 {
            margin: 0 0 18px 0; font-size: 1.5rem; color: var(--primary);
        }
        #install-body {
            font-size: 0.95rem; line-height: 1.55; margin-bottom: 24px; color: var(--text);
            max-height: 260px;
            overflow-y: auto;
            padding-right: 8px;
            text-align: left;
            scrollbar-width: thin;
            scrollbar-color: var(--accent) var(--input-bg);
        }
        #install-body strong { color: var(--accent); }
        .install-btn {
            background: var(--primary); color: white; border: none;
            padding: 14px 32px; border-radius: 14px; font-size: 1rem;
            font-weight: 600; cursor: pointer; width: 100%;
            transition: all 0.2s;
        }
        .install-btn:active { transform: scale(0.96); }
    </style>
</head>
<body>

<div class="card" id="app">
    <div class="top-bar">
        <button class="theme-toggle" onclick="toggleTheme()" id="theme-icon">ğŸŒ™</button>
        <div class="lang-bar">
            <button class="lang-btn active" onclick="setLang('tr')">TR</button>
            <button class="lang-btn" onclick="setLang('en')">EN</button>
            <button class="lang-btn" onclick="setLang('ar')">AR</button>
            <button class="lang-btn" onclick="setLang('fr')">FR</button>
        </div>
    </div>

    <div class="logo-container">
        <img src="data:image/png;base64,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" id="logo-light" alt="Logo Light">
        <img src="data:image/png;base64,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" id="logo-dark" alt="Logo Dark">
    </div>

    <div class="date-time-bar">
        <div id="miladi-display" class="miladi-date">ğŸ“… ...</div>
        <div id="real-clock" class="real-clock">00:00:00</div>
    </div>
    <div id="hicri-display" class="hicri-date">â˜ªï¸ -- Ramadan 1447</div>
    
    <div class="search-container">
        <div class="search-box">
            <input type="text" id="city-input" placeholder="Åehir..." oninput="handleInput(this.value)" autocomplete="off">
            <button onclick="searchCity()" style="background:var(--primary); color:white; border:none; padding:10px 15px; border-radius:12px; cursor:pointer;">ğŸ”</button>
        </div>
        <h2 id="display-city">...</h2>
        <div id="suggestions" class="suggestions"></div>
    </div>

    <div class="countdown-area">
        <div id="countdown-label">YÃ¼kleniyor...</div>
        <div id="timer">00:00:00</div>
        <div class="progress-container"><div class="progress-fill" id="progress-bar"></div></div>
    </div>

    <div class="vakit-grid">
        <div class="vakit-item">
            <div style="font-size: 0.7rem; color: #94a3b8;" id="lbl-sahur">Sahur</div>
            <div class="vakit-time" id="time-fajr">--:--</div>
        </div>
        <div class="vakit-item">
            <div style="font-size: 0.7rem; color: #94a3b8;" id="lbl-iftar">Ä°ftar</div>
            <div class="vakit-time" id="time-maghrib">--:--</div>
        </div>
    </div>

    <div class="tool-grid">
        <button class="tool-btn" onclick="showQibla()">ğŸ§­ <span id="lbl-qibla">KÄ±ble</span></button>
        <button class="tool-btn" onclick="shareHadith()">ğŸ“¤ <span id="lbl-share">PaylaÅŸ</span></button>
    </div>

    <div class="hadith-area">
        <strong id="lbl-h-title" style="color:var(--highlight); display:block; margin-bottom:8px;">GÃ¼nÃ¼n Hadisi</strong>
        <p id="hadith-text" class="hadith-text">...</p>
        <p id="hadith-narrator" style="font-style:italic; color:#94a3b8; margin-top:12px; font-size:0.85rem; text-align:right;">...</p>
    </div>
</div>

<!-- KÄ±ble PusulasÄ± Modal -->
<div id="qibla-modal">
    <div class="qibla-box">
        <h3>ğŸ§­ <span id="modal-qibla-title">KÄ±ble PusulasÄ±</span></h3>
        <p class="sub" id="modal-qibla-sub">CihazÄ±nÄ±zÄ± dÃ¼z tutun</p>

        <div class="compass-wrap" id="compass-wrap">
            <div id="compass-ring">
                <div class="compass-letters">
                    <span class="cn">K</span>
                    <span class="cs">G</span>
                    <span class="ce">D</span>
                    <span class="cw">B</span>
                </div>
            </div>
            <div id="north-needle"></div>
            <div id="south-needle"></div>
            <div id="qibla-arrow"></div>
            <div class="compass-center"></div>
        </div>

        <div class="qibla-degree"><span id="qibla-angle-display">--</span>Â°</div>
        <div class="qibla-status searching" id="qibla-status-text">ğŸ“¡ Pusula bekleniyor...</div>
        <br><br>
        <button id="qibla-close" onclick="closeQibla()">Kapat</button>
    </div>
</div>

<!-- ====================== Ä°LK AÃ‡ILIÅ POPUP MODALI ====================== -->
<div id="install-modal" onclick="if(event.target.id==='install-modal') closeInstallModal()">
    <div class="install-box">
        <h2 id="install-title">ğŸ“± Ana Ekrana Ekleyin</h2>
        <div id="install-body"></div>
        <button class="install-btn" onclick="closeInstallModal()">AnladÄ±m, Kapat</button>
    </div>
</div>

<script>
    const hadithList = [
        { 
            tr: "Sizin en hayÄ±rlÄ±nÄ±z, Kur'an'Ä± Ã¶ÄŸrenen ve Ã¶ÄŸreteninizdir.", 
            en: "The best among you are those who learn the Qur'an and teach it.", 
            ar: "Ø®ÙŠØ§Ø±ÙƒÙ… Ù…Ù† ØªØ¹Ù„Ù… Ø§Ù„Ù‚Ø±Ø¢Ù† ÙˆØ¹Ù„Ù…Ù‡", 
            fr: "Le meilleur d'entre vous est celui qui apprend le Coran et l'enseigne.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "Bir hayra vesile olan, onu yapan gibidir.", 
            en: "Whoever guides someone to goodness will have a reward like one who did it.", 
            ar: "Ù…Ù† Ø¯Ù„ Ø¹Ù„Ù‰ Ø®ÙŠØ± ÙÙ„Ù‡ Ù…Ø«Ù„ Ø£Ø¬Ø± ÙØ§Ø¹Ù„Ù‡", 
            fr: "Celui qui guide vers un bien a la mÃªme rÃ©compense que celui qui l'a fait.",
            narrator: { tr: "MÃ¼slim", en: "Muslim", ar: "Ù…Ø³Ù„Ù…", fr: "Muslim" }
        },
        { 
            tr: "Allah katÄ±nda amellerin en sevimlisi az da olsa devamlÄ± olanÄ±dÄ±r.", 
            en: "The most beloved of deeds to Allah are those that are most consistent, even if they are small.", 
            ar: "Ø£Ø­Ø¨ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡ Ø£Ø¯ÙˆÙ…Ù‡Ø§ ÙˆØ¥Ù† Ù‚Ù„", 
            fr: "Les Å“uvres les plus aimÃ©es d'Allah sont les plus rÃ©guliÃ¨res, mÃªme si elles sont peu nombreuses.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "Temizlik imanÄ±n yarÄ±sÄ±dÄ±r.", 
            en: "Purity is half of faith.", 
            ar: "Ø§Ù„Ø·Ù‡ÙˆØ± Ø´Ø·Ø± Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†", 
            fr: "La puretÃ© est la moitiÃ© de la foi.",
            narrator: { tr: "MÃ¼slim", en: "Muslim", ar: "Ù…Ø³Ù„Ù…", fr: "Muslim" }
        },
        { 
            tr: "Dua ibadetin Ã¶zÃ¼dÃ¼r.", 
            en: "Dua (supplication) is the essence of worship.", 
            ar: "Ø§Ù„Ø¯Ø¹Ø§Ø¡ Ù…Ø® Ø§Ù„Ø¹Ø¨Ø§Ø¯Ø©", 
            fr: "L'invocation est la moelle de l'adoration.",
            narrator: { tr: "Tirmizi", en: "Tirmidhi", ar: "Ø§Ù„ØªØ±Ù…Ø°ÙŠ", fr: "Tirmidhi" }
        },
        { 
            tr: "Kim bir mÃ¼slÃ¼manÄ±n kusurunu Ã¶rterse, Allah da dÃ¼nya ve ahirette onun kusurunu Ã¶rter.", 
            en: "Whoever conceals the faults of a Muslim, Allah will conceal his faults in this world and the Hereafter.", 
            ar: "Ù…Ù† Ø³ØªØ± Ù…Ø³Ù„Ù…Ø§Ù‹ Ø³ØªØ±Ù‡ Ø§Ù„Ù„Ù‡ ÙÙŠ Ø§Ù„Ø¯Ù†ÙŠØ§ ÙˆØ§Ù„Ø¢Ø®Ø±Ø©", 
            fr: "Quiconque couvre les fautes d'un musulman, Allah couvrira ses fautes dans ce monde et dans l'au-delÃ .",
            narrator: { tr: "MÃ¼slim", en: "Muslim", ar: "Ù…Ø³Ù„Ù…", fr: "Muslim" }
        },
        { 
            tr: "GÃ¼zel sÃ¶z sadakadÄ±r.", 
            en: "A good word is charity.", 
            ar: "Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø·ÙŠØ¨Ø© ØµØ¯Ù‚Ø©", 
            fr: "Une bonne parole est une aumÃ´ne.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "KomÅŸusu aÃ§ken tok yatan bizden deÄŸildir.", 
            en: "He is not a believer whose stomach is filled while the neighbor to his side goes hungry.", 
            ar: "Ù„ÙŠØ³ Ø§Ù„Ù…Ø¤Ù…Ù† Ø§Ù„Ø°ÙŠ ÙŠØ´Ø¨Ø¹ ÙˆØ¬Ø§Ø±Ù‡ Ø¬Ø§Ø¦Ø¹", 
            fr: "N'est pas croyant celui qui mange Ã  sa faim alors que son voisin a faim.",
            narrator: { tr: "Hakim", en: "Al-Hakim", ar: "Ø§Ù„Ø­Ø§ÙƒÙ…", fr: "Al-Hakim" }
        },
        { 
            tr: "Hasetten sakÄ±nÄ±n. Ã‡Ã¼nkÃ¼ ateÅŸin odunu yakÄ±p tÃ¼kettiÄŸi gibi haset de iyi amelleri yakÄ±p tÃ¼ketir.", 
            en: "Avoid envy, for envy devours good deeds just as fire devours firewood.", 
            ar: "Ø¥ÙŠØ§ÙƒÙ… ÙˆØ§Ù„Ø­Ø³Ø¯ ÙØ¥Ù† Ø§Ù„Ø­Ø³Ø¯ ÙŠØ£ÙƒÙ„ Ø§Ù„Ø­Ø³Ù†Ø§Øª ÙƒÙ…Ø§ ØªØ£ÙƒÙ„ Ø§Ù„Ù†Ø§Ø± Ø§Ù„Ø­Ø·Ø¨", 
            fr: "MÃ©fiez-vous de l'envie, car l'envie dÃ©vore les bonnes actions comme le feu dÃ©vore le bois.",
            narrator: { tr: "Ebu Davud", en: "Abu Dawud", ar: "Ø£Ø¨Ùˆ Ø¯Ø§ÙˆØ¯", fr: "Abu Dawud" }
        },
        { 
            tr: "MÃ¼'min bir delikten iki defa Ä±sÄ±rÄ±lmaz.", 
            en: "A believer is not stung from the same hole twice.", 
            ar: "Ù„Ø§ ÙŠÙ„Ø¯Øº Ø§Ù„Ù…Ø¤Ù…Ù† Ù…Ù† Ø¬Ø­Ø± Ù…Ø±ØªÙŠÙ†", 
            fr: "Le croyant n'est pas piquÃ© deux fois par le mÃªme trou.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "KolaylaÅŸtÄ±rÄ±nÄ±z, zorlaÅŸtÄ±rmayÄ±nÄ±z; mÃ¼jdeleyiniz, nefret ettirmeyiniz.", 
            en: "Make things easy and do not make them difficult; give glad tidings and do not repel people.", 
            ar: "ÙŠØ³Ø±ÙˆØ§ ÙˆÙ„Ø§ ØªØ¹Ø³Ø±ÙˆØ§ ÙˆØ¨Ø´Ø±ÙˆØ§ ÙˆÙ„Ø§ ØªÙ†ÙØ±ÙˆØ§", 
            fr: "Facilitez et ne rendez pas difficile, annoncez la bonne nouvelle et ne rebutez pas les gens.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "Sizden biriniz kendisi iÃ§in istediÄŸini kardeÅŸi iÃ§in de istemedikÃ§e iman etmiÅŸ olmaz.", 
            en: "None of you truly believes until he loves for his brother what he loves for himself.", 
            ar: "Ù„Ø§ ÙŠØ¤Ù…Ù† Ø£Ø­Ø¯ÙƒÙ… Ø­ØªÙ‰ ÙŠØ­Ø¨ Ù„Ø£Ø®ÙŠÙ‡ Ù…Ø§ ÙŠØ­Ø¨ Ù„Ù†ÙØ³Ù‡", 
            fr: "Aucun de vous ne sera croyant tant qu'il n'aimera pas pour son frÃ¨re ce qu'il aime pour lui-mÃªme.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "Ä°nsanlara merhamet etmeyene Allah da merhamet etmez.", 
            en: "Allah will not show mercy to those who do not show mercy to people.", 
            ar: "Ù…Ù† Ù„Ø§ ÙŠØ±Ø­Ù… Ø§Ù„Ù†Ø§Ø³ Ù„Ø§ ÙŠØ±Ø­Ù…Ù‡ Ø§Ù„Ù„Ù‡", 
            fr: "Allah ne fait pas misÃ©ricorde Ã  celui qui ne fait pas misÃ©ricorde aux hommes.",
            narrator: { tr: "MÃ¼slim", en: "Muslim", ar: "Ù…Ø³Ù„Ù…", fr: "Muslim" }
        },
        { 
            tr: "ZulÃ¼m, kÄ±yamet gÃ¼nÃ¼nde karanlÄ±klardÄ±r.", 
            en: "Oppression will be darkness on the Day of Resurrection.", 
            ar: "Ø§Ù„Ø¸Ù„Ù… Ø¸Ù„Ù…Ø§Øª ÙŠÙˆÙ… Ø§Ù„Ù‚ÙŠØ§Ù…Ø©", 
            fr: "L'injustice sera tÃ©nÃ¨bres le jour de la rÃ©surrection.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "Bizi aldatan bizden deÄŸildir.", 
            en: "Whoever deceives us is not one of us.", 
            ar: "Ù…Ù† ØºØ´Ù†Ø§ ÙÙ„ÙŠØ³ Ù…Ù†Ø§", 
            fr: "Celui qui nous trompe n'est pas des nÃ´tres.",
            narrator: { tr: "MÃ¼slim", en: "Muslim", ar: "Ù…Ø³Ù„Ù…", fr: "Muslim" }
        },
        { 
            tr: "Ä°man yetmiÅŸ kÃ¼sur ÅŸubedir. En Ã¼stÃ¼nÃ¼ 'LÃ¢ ilÃ¢he illallah' demektir.", 
            en: "Faith has over seventy branches. The best of it is the saying: There is no god but Allah.", 
            ar: "Ø§Ù„Ø¥ÙŠÙ…Ø§Ù† Ø¨Ø¶Ø¹ ÙˆØ³Ø¨Ø¹ÙˆÙ† Ø´Ø¹Ø¨Ø© Ø£ÙØ¶Ù„Ù‡Ø§ Ù‚ÙˆÙ„ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡", 
            fr: "La foi comporte soixante-dix et quelques branches. La meilleure est : Il n'y a de divinitÃ© qu'Allah.",
            narrator: { tr: "MÃ¼slim", en: "Muslim", ar: "Ù…Ø³Ù„Ù…", fr: "Muslim" }
        },
        { 
            tr: "GerÃ§ek zenginlik mal Ã§okluÄŸu deÄŸil, gÃ¶nÃ¼l zenginliÄŸidir.", 
            en: "Richness is not in abundance of worldly goods, but true richness is the richness of the soul.", 
            ar: "Ù„ÙŠØ³ Ø§Ù„ØºÙ†Ù‰ Ø¹Ù† ÙƒØ«Ø±Ø© Ø§Ù„Ø¹Ø±Ø¶ ÙˆÙ„ÙƒÙ† Ø§Ù„ØºÙ†Ù‰ ØºÙ†Ù‰ Ø§Ù„Ù†ÙØ³", 
            fr: "La richesse ne consiste pas en l'abondance des biens, mais la vraie richesse est celle de l'Ã¢me.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "UtanmÄ±yorsan dilediÄŸini yap!", 
            en: "If you feel no shame, then do as you wish.", 
            ar: "Ø¥Ø°Ø§ Ù„Ù… ØªØ³ØªØ­ ÙØ§ØµÙ†Ø¹ Ù…Ø§ Ø´Ø¦Øª", 
            fr: "Si tu n'as pas de pudeur, alors fais ce que tu veux.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "Haya imandandÄ±r.", 
            en: "Modesty is part of faith.", 
            ar: "Ø§Ù„Ø­ÙŠØ§Ø¡ Ù…Ù† Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†", 
            fr: "La pudeur fait partie de la foi.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "Din nasihattir (samimiyettir).", 
            en: "Religion is sincerity.", 
            ar: "Ø§Ù„Ø¯ÙŠÙ† Ø§Ù„Ù†ØµÙŠØ­Ø©", 
            fr: "La religion est le bon conseil.",
            narrator: { tr: "MÃ¼slim", en: "Muslim", ar: "Ù…Ø³Ù„Ù…", fr: "Muslim" }
        },
        { 
            tr: "Ä°ki nimet vardÄ±r ki insanlarÄ±n Ã§oÄŸu bunda aldanmÄ±ÅŸtÄ±r: SaÄŸlÄ±k ve boÅŸ vakit.", 
            en: "There are two blessings which many people lose: health and free time.", 
            ar: "Ù†Ø¹Ù…ØªØ§Ù† Ù…ØºØ¨ÙˆÙ† ÙÙŠÙ‡Ù…Ø§ ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ù†Ø§Ø³ Ø§Ù„ØµØ­Ø© ÙˆØ§Ù„ÙØ±Ø§Øº", 
            fr: "Deux bienfaits dont beaucoup de gens sont privÃ©s : la santÃ© et le temps libre.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "Ä°ÅŸÃ§iye Ã¼cretini teri kurumadan veriniz.", 
            en: "Give the worker his wages before his sweat dries.", 
            ar: "Ø£Ø¹Ø·ÙˆØ§ Ø§Ù„Ø£Ø¬ÙŠØ± Ø£Ø¬Ø±Ù‡ Ù‚Ø¨Ù„ Ø£Ù† ÙŠØ¬Ù Ø¹Ø±Ù‚Ù‡", 
            fr: "Donnez Ã  l'employÃ© son salaire avant que sa sueur ne sÃ¨che.",
            narrator: { tr: "Ä°bn Mace", en: "Ibn Majah", ar: "Ø§Ø¨Ù† Ù…Ø§Ø¬Ù‡", fr: "Ibn Majah" }
        },
        { 
            tr: "En hayÄ±rlÄ± ev, iÃ§inde yetime ikram edilen evdir.", 
            en: "The best house is a house in which an orphan is treated well.", 
            ar: "Ø®ÙŠØ± Ø¨ÙŠØª ÙÙŠ Ø§Ù„Ù…Ø³Ù„Ù…ÙŠÙ† Ø¨ÙŠØª ÙÙŠÙ‡ ÙŠØªÙŠÙ… ÙŠØ­Ø³Ù† Ø¥Ù„ÙŠÙ‡", 
            fr: "La meilleure maison est celle oÃ¹ un orphelin est bien traitÃ©.",
            narrator: { tr: "Ä°bn Mace", en: "Ibn Majah", ar: "Ø§Ø¨Ù† Ù…Ø§Ø¬Ù‡", fr: "Ibn Majah" }
        },
        { 
            tr: "Sizden biriniz bir iÅŸ yaptÄ±ÄŸÄ±nda onu saÄŸlam yapmasÄ± Allah'Ä±n sevdiÄŸi bir iÅŸtir.", 
            en: "Allah loves that when one of you does a job, he does it perfectly.", 
            ar: "Ø¥Ù† Ø§Ù„Ù„Ù‡ ÙŠØ­Ø¨ Ø¥Ø°Ø§ Ø¹Ù…Ù„ Ø£Ø­Ø¯ÙƒÙ… Ø¹Ù…Ù„Ø§ Ø£Ù† ÙŠØªÙ‚Ù†Ù‡", 
            fr: "Allah aime que lorsque l'un de vous fait un travail, il le fasse avec perfection.",
            narrator: { tr: "Beyhaki", en: "Al-Bayhaqi", ar: "Ø§Ù„Ø¨ÙŠÙ‡Ù‚ÙŠ", fr: "Al-Bayhaqi" }
        },
        { 
            tr: "DÃ¼nyada bir garip veya bir yolcu gibi ol.", 
            en: "Be in this world as if you were a stranger or a traveler.", 
            ar: "ÙƒÙ† ÙÙŠ Ø§Ù„Ø¯Ù†ÙŠØ§ ÙƒØ£Ù†Ùƒ ØºØ±ÙŠØ¨ Ø£Ùˆ Ø¹Ø§Ø¨Ø± Ø³Ø¨ÙŠÙ„", 
            fr: "Sois dans ce monde comme un Ã©tranger ou un voyageur.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "Kim Allah'a ve ahiret gÃ¼nÃ¼ne inanÄ±yorsa komÅŸusuna eziyet etmesin.", 
            en: "Whoever believes in Allah and the Last Day, let him not harm his neighbor.", 
            ar: "Ù…Ù† ÙƒØ§Ù† ÙŠØ¤Ù…Ù† Ø¨Ø§Ù„Ù„Ù‡ ÙˆØ§Ù„ÙŠÙˆÙ… Ø§Ù„Ø¢Ø®Ø± ÙÙ„Ø§ ÙŠØ¤Ø° Ø¬Ø§Ø±Ù‡", 
            fr: "Celui qui croit en Allah et au Jour Dernier ne doit pas nuire Ã  son voisin.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "Ä°lim talep etmek her MÃ¼slÃ¼mana farzdÄ±r.", 
            en: "Seeking knowledge is an obligation upon every Muslim.", 
            ar: "Ø·Ù„Ø¨ Ø§Ù„Ø¹Ù„Ù… ÙØ±ÙŠØ¶Ø© Ø¹Ù„Ù‰ ÙƒÙ„ Ù…Ø³Ù„Ù…", 
            fr: "La recherche de la science est une obligation pour chaque musulman.",
            narrator: { tr: "Ä°bn Mace", en: "Ibn Majah", ar: "Ø§Ø¨Ù† Ù…Ø§Ø¬Ù‡", fr: "Ibn Majah" }
        },
        { 
            tr: "RÄ±zkÄ±nÄ±n bollaÅŸmasÄ±nÄ± ve Ã¶mrÃ¼nÃ¼n uzamasÄ±nÄ± isteyen akrabasÄ±nÄ± ziyaret etsin.", 
            en: "Whoever would like his provision to be increased and his life to be extended, should uphold the ties of kinship.", 
            ar: "Ù…Ù† Ø£Ø­Ø¨ Ø£Ù† ÙŠØ¨Ø³Ø· Ù„Ù‡ ÙÙŠ Ø±Ø²Ù‚Ù‡ ÙˆÙŠÙ†Ø³Ø£ Ù„Ù‡ ÙÙŠ Ø£Ø«Ø±Ù‡ ÙÙ„ÙŠØµÙ„ Ø±Ø­Ù…Ù‡", 
            fr: "Celui qui aimerait que ses subsistances soient Ã©largies et sa vie prolongÃ©e, qu'il entretienne ses liens de parentÃ©.",
            narrator: { tr: "Buhari", en: "Bukhari", ar: "Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ", fr: "Bukhari" }
        },
        { 
            tr: "Cennet annelerin ayaklarÄ± altÄ±ndadÄ±r.", 
            en: "Paradise lies at the feet of mothers.", 
            ar: "Ø§Ù„Ø¬Ù†Ø© ØªØ­Øª Ø£Ù‚Ø¯Ø§Ù… Ø§Ù„Ø£Ù…Ù‡Ø§Øª", 
            fr: "Le paradis est aux pieds des mÃ¨res.",
            narrator: { tr: "Nesai", en: "An-Nasa'i", ar: "Ø§Ù„Ù†Ø³Ø§Ø¦ÙŠ", fr: "An-Nasa'i" }
        },
        { 
            tr: "MÃ¼slÃ¼man mÃ¼slÃ¼manÄ±n kardeÅŸidir.", 
            en: "A Muslim is a brother of another Muslim.", 
            ar: "Ø§Ù„Ù…Ø³Ù„Ù… Ø£Ø®Ùˆ Ø§Ù„Ù…Ø³Ù„Ù…", 
            fr: "Le musulman est le frÃ¨re du musulman.",
            narrator: { tr: "MÃ¼slim", en: "Muslim", ar: "Ù…Ø³Ù„Ù…", fr: "Muslim" }
        }
    ];

    const i18n = {
        tr: { 
            sahur: "Sahur", iftar: "Ä°ftar", qibla: "KÄ±ble", share: "PaylaÅŸ", 
            leftIftar: "Ä°ftara Kalan", leftSahur: "Sahura Kalan", dir: "ltr",
            cityPlaceholder: "Åehir...",
            hadithTitle: "GÃ¼nÃ¼n Hadisi",
            modalQiblaTitle: "KÄ±ble PusulasÄ±",
            modalQiblaSub: "CihazÄ±nÄ±zÄ± dÃ¼z tutun",
            qiblaStatusSearching: "ğŸ“¡ Pusula sinyali bekleniyorâ€¦",
            qiblaStatusLocked: "âœ… KÄ±bleyi buldunuz!",
            qiblaStatusNoSensor: "âš ï¸ SensÃ¶r verisi alÄ±namadÄ±. TarayÄ±cÄ± ayarlarÄ±ndan harekete izin verin.",
            permissionDenied: "âš ï¸ Pusula izni reddedildi. Ayarlar â†’ Safari â†’ Hareket ve YÃ¶nelim",
            noSupport: "âš ï¸ Bu tarayÄ±cÄ± pusula sensÃ¶rÃ¼nÃ¼ desteklemiyor.",
            closeBtn: "Kapat"
        },
        en: { 
            sahur: "Suhoor", iftar: "Iftar", qibla: "Qibla", share: "Share", 
            leftIftar: "Until Iftar", leftSahur: "Until Suhoor", dir: "ltr",
            cityPlaceholder: "City...",
            hadithTitle: "Hadith of the Day",
            modalQiblaTitle: "Qibla Compass",
            modalQiblaSub: "Hold your device flat",
            qiblaStatusSearching: "ğŸ“¡ Waiting for compass signalâ€¦",
            qiblaStatusLocked: "âœ… You found the Qibla!",
            qiblaStatusNoSensor: "âš ï¸ No sensor data. Allow motion in browser settings.",
            permissionDenied: "âš ï¸ Compass permission denied.",
            noSupport: "âš ï¸ This browser does not support compass sensor.",
            closeBtn: "Close"
        },
        ar: { 
            sahur: "Ø§Ù„Ø³Ø­ÙˆØ±", iftar: "Ø§Ù„Ø¥ÙØ·Ø§Ø±", qibla: "Ø§Ù„Ù‚Ø¨Ù„Ø©", share: "Ù…Ø´Ø§Ø±ÙƒØ©", 
            leftIftar: "Ø¨Ø§Ù‚ÙŠ Ù„Ù„Ø¥ÙØ·Ø§Ø±", leftSahur: "Ø¨Ø§Ù‚ÙŠ Ù„Ù„Ø³Ø­ÙˆØ±", dir: "rtl",
            cityPlaceholder: "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©...",
            hadithTitle: "Ø­Ø¯ÙŠØ« Ø§Ù„ÙŠÙˆÙ…",
            modalQiblaTitle: "Ø¨ÙˆØµÙ„Ø© Ø§Ù„Ù‚Ø¨Ù„Ø©",
            modalQiblaSub: "Ø§Ù…Ø³Ùƒ Ø¬Ù‡Ø§Ø²Ùƒ Ø¨Ø´ÙƒÙ„ Ù…Ø³Ø·Ø­",
            qiblaStatusSearching: "ğŸ“¡ Ø§Ù†ØªØ¸Ø§Ø± Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø¨ÙˆØµÙ„Ø©â€¦",
            qiblaStatusLocked: "âœ… ÙˆØ¬Ø¯Øª Ø§Ù„Ù‚Ø¨Ù„Ø©!",
            qiblaStatusNoSensor: "âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ´Ø¹Ø±. Ø§Ø³Ù…Ø­ Ø¨Ø§Ù„Ø­Ø±ÙƒØ© ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØµÙØ­.",
            permissionDenied: "âš ï¸ ØªÙ… Ø±ÙØ¶ Ø¥Ø°Ù† Ø§Ù„Ø¨ÙˆØµÙ„Ø©.",
            noSupport: "âš ï¸ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­ Ù…Ø³ØªØ´Ø¹Ø± Ø§Ù„Ø¨ÙˆØµÙ„Ø©.",
            closeBtn: "Ø¥ØºÙ„Ø§Ù‚"
        },
        fr: { 
            sahur: "Suhur", iftar: "Iftar", qibla: "Qibla", share: "Partager", 
            leftIftar: "Jusqu'Ã  l'Iftar", leftSahur: "Jusqu'au Suhur", dir: "ltr",
            cityPlaceholder: "Ville...",
            hadithTitle: "Hadith du Jour",
            modalQiblaTitle: "Boussole Qibla",
            modalQiblaSub: "Tenez votre appareil Ã  plat",
            qiblaStatusSearching: "ğŸ“¡ En attente du signal de la boussoleâ€¦",
            qiblaStatusLocked: "âœ… Vous avez trouvÃ© la Qibla !",
            qiblaStatusNoSensor: "âš ï¸ Aucune donnÃ©e de capteur. Autorisez le mouvement dans les paramÃ¨tres du navigateur.",
            permissionDenied: "âš ï¸ Permission boussole refusÃ©e.",
            noSupport: "âš ï¸ Ce navigateur ne prend pas en charge le capteur de boussole.",
            closeBtn: "Fermer"
        }
    };

    // ====================== TÃœM DÄ°LLER Ä°Ã‡Ä°N BÄ°RLEÅÄ°K Ä°LK AÃ‡ILIÅ POPUP METNÄ° ======================
    const multiLangInstallHTML = `
        <p style="margin-bottom:18px;"><strong>ğŸ“± Bu uygulamayÄ± ana ekranÄ±nÄ±za ekleyin / Add this app to your home screen / Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¥Ù„Ù‰ Ø´Ø§Ø´ØªÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© / Ajoutez cette application Ã  votre Ã©cran dâ€™accueil</strong></p>
        
        <p><strong>TÃ¼rkÃ§e:</strong><br>
        Bu uygulamayÄ± ana ekranÄ±nÄ±za ekleyin, her zaman hÄ±zlÄ±ca aÃ§Ä±n!<br><br>
        <strong>Android:</strong> TarayÄ±cÄ±nÄ±zÄ±n saÄŸ Ã¼st kÃ¶ÅŸesindeki â‹® Ã¼Ã§ noktaya dokunun â†’ <strong>Ana ekrana ekle</strong><br>
        <strong>iPhone:</strong> PaylaÅŸ butonuna (â–¡â†‘) dokunun â†’ <strong>Ana Ekrana Ekle</strong></p>
        
        <p><strong>English:</strong><br>
        Add this app to your home screen for quick access anytime!<br><br>
        <strong>Android:</strong> Tap the â‹® three dots in the top-right of your browser â†’ <strong>Add to home screen</strong><br>
        <strong>iPhone:</strong> Tap the Share button (â–¡â†‘) â†’ <strong>Add to Home Screen</strong></p>
        
        <p dir="rtl"><strong>Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©:</strong><br>
        Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¥Ù„Ù‰ Ø´Ø§Ø´ØªÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª!<br><br>
        <strong>Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯:</strong> Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø«Ù„Ø§Ø« â‹® Ø£Ø¹Ù„Ù‰ ÙŠÙ…ÙŠÙ† Ø§Ù„Ù…ØªØµÙØ­ â†’ <strong>Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</strong><br>
        <strong>Ø¢ÙŠÙÙˆÙ†:</strong> Ø§Ø¶ØºØ· Ø²Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© (â–¡â†‘) â†’ <strong>Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</strong></p>
        
        <p><strong>FranÃ§ais:</strong><br>
        Ajoutez cette application Ã  votre Ã©cran dâ€™accueil pour un accÃ¨s rapide Ã  tout moment !<br><br>
        <strong>Android :</strong> Appuyez sur les trois points â‹® en haut Ã  droite du navigateur â†’ <strong>Ajouter Ã  lâ€™Ã©cran dâ€™accueil</strong><br>
        <strong>iPhone :</strong> Appuyez sur le bouton Partager (â–¡â†‘) â†’ <strong>Ajouter Ã  lâ€™Ã©cran dâ€™accueil</strong></p>
    `;

    let currentLang = 'tr', times = {}, qiblaAngle = 0;
    let currentLat = null, currentLon = null;

    function toggleTheme() {
        const body = document.documentElement;
        const icon = document.getElementById('theme-icon');
        if (body.getAttribute('data-theme') === 'dark') {
            body.removeAttribute('data-theme'); icon.innerText = 'ğŸŒ™';
            localStorage.setItem('theme', 'light');
        } else {
            body.setAttribute('data-theme', 'dark'); icon.innerText = 'â˜€ï¸';
            localStorage.setItem('theme', 'dark');
        }
    }

    function setLang(lang) {
        currentLang = lang;
        const t = i18n[lang];
        document.getElementById('lbl-sahur').innerText = t.sahur;
        document.getElementById('lbl-iftar').innerText = t.iftar;
        document.getElementById('lbl-qibla').innerText = t.qibla;
        document.getElementById('lbl-share').innerText = t.share;
        document.getElementById('city-input').placeholder = t.cityPlaceholder;
        document.getElementById('lbl-h-title').innerText = t.hadithTitle;
        document.getElementById('modal-qibla-title').innerText = t.modalQiblaTitle;
        document.getElementById('modal-qibla-sub').innerText = t.modalQiblaSub;
        document.getElementById('qibla-close').innerText = t.closeBtn;
        document.getElementById('app').dir = t.dir;

        const idx = new Date().getDate() % hadithList.length;
        const had = hadithList[idx];
        document.getElementById('hadith-text').innerText = had[lang];
        document.getElementById('hadith-narrator').innerText = had.narrator[lang];

        document.querySelectorAll('.lang-btn').forEach(b => b.classList.toggle('active', b.innerText.toLowerCase() === lang));
        document.getElementById('miladi-display').innerText = getMiladiText(lang);
    }

    async function handleInput(val) {
        const box = document.getElementById('suggestions');
        if (val.length < 3) return box.style.display = 'none';
        const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${val}&limit=5`);
        const data = await res.json();
        box.innerHTML = '';
        data.forEach(d => {
            const div = document.createElement('div'); div.className = 's-item';
            div.innerText = d.display_name.split(',')[0];
            div.onclick = () => {
                document.getElementById('city-input').value = div.innerText;
                box.style.display = 'none';
                searchCity();
            };
            box.appendChild(div);
        });
        box.style.display = 'block';
    }

    // TÃ¼rkÃ§e karakter normalizasyonu (ÅŸehir adÄ± karÅŸÄ±laÅŸtÄ±rmasÄ± iÃ§in)
    function normalizeTR(s) {
        return (s || '').toUpperCase()
            .replace(/Ä°/g, 'I').replace(/Ä/g, 'G').replace(/Å/g, 'S')
            .replace(/Ãœ/g, 'U').replace(/Ã–/g, 'O').replace(/Ã‡/g, 'C')
            .replace(/I/g, 'I').trim();
    }

    async function searchCity() {
        const cityInput = document.getElementById('city-input').value.trim();
        if (!cityInput) return;

        let geoData;
        try {
            const geoRes = await fetch(
                `https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&q=${encodeURIComponent(cityInput)}&limit=1`
            );
            geoData = await geoRes.json();
        } catch (e) {
            alert('Konum servisi ÅŸu anda kullanÄ±lamÄ±yor.');
            return;
        }

        if (!geoData || geoData.length === 0) {
            alert('Konum bulunamadÄ±!');
            return;
        }

        const lat = parseFloat(geoData[0].lat);
        const lon = parseFloat(geoData[0].lon);
        currentLat = lat;
        currentLon = lon;

        const countryCode = (geoData[0].address?.country_code || '').toLowerCase();
        const displayName = cityInput.toUpperCase().split(',')[0];

        document.getElementById('display-city').innerText = displayName;

        if (countryCode === 'tr') {
            await fetchDiyanetTimes(cityInput, lat, lon);
        } else {
            await fetchAlAdhanTimes(lat, lon, cityInput);
        }
    }

    // â”€â”€â”€ Diyanet API (TÃ¼rkiye) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function fetchDiyanetTimes(cityInput, lat, lon) {
        const TURKEY_DIYANET_ID = 2;
        const cityName = cityInput.split(',')[0].trim();
        const cityNorm = normalizeTR(cityName);

        try {
            // 1. Åehir listesini Ã§ek
            const sehirRes = await fetch(`https://ezanvakti.emushaf.net/sehirler/${TURKEY_DIYANET_ID}`);
            const sehirList = await sehirRes.json();

            // 2. Girilen ÅŸehri bul (tam eÅŸleÅŸme â†’ iÃ§erik eÅŸleÅŸme)
            let sehir = sehirList.find(s => normalizeTR(s.SehirAdi) === cityNorm)
                     || sehirList.find(s => normalizeTR(s.SehirAdi).includes(cityNorm))
                     || sehirList.find(s => cityNorm.includes(normalizeTR(s.SehirAdi)));

            if (!sehir) {
                console.warn('Diyanet: Åehir bulunamadÄ±, AlAdhan yedek kullanÄ±lÄ±yor.');
                return fetchAlAdhanTimes(lat, lon, cityInput);
            }

            // 3. Ä°lÃ§e listesini Ã§ek
            const ilceRes = await fetch(`https://ezanvakti.emushaf.net/ilceler/${sehir.SehirID}`);
            const ilceList = await ilceRes.json();

            // 4. Merkez ilÃ§eyi veya ilk ilÃ§eyi seÃ§
            const ilce = ilceList.find(i => normalizeTR(i.IlceAdi) === cityNorm)
                      || ilceList.find(i => normalizeTR(i.IlceAdi).includes('MERKEZ'))
                      || ilceList[0];

            // 5. Vakitleri Ã§ek (30 gÃ¼nlÃ¼k liste)
            const vakitRes = await fetch(`https://ezanvakti.emushaf.net/vakitler/${ilce.IlceID}`);
            const vakitList = await vakitRes.json();

            // 6. BugÃ¼nÃ¼n verisini bul
            const today = new Date();
            const dd  = String(today.getDate()).padStart(2, '0');
            const mm  = String(today.getMonth() + 1).padStart(2, '0');
            const yyyy = today.getFullYear();
            const todayKisa = `${dd}.${mm}.${yyyy}`;

            const todayVakit = vakitList.find(v => v.MiladiTarihKisa === todayKisa)
                            || vakitList.find(v => (v.MiladiTarihUzunIso8601 || '').startsWith(`${yyyy}-${mm}-${dd}`))
                            || vakitList[0];

            if (!todayVakit) {
                console.warn('Diyanet: BugÃ¼nÃ¼n vakti bulunamadÄ±, AlAdhan yedek kullanÄ±lÄ±yor.');
                return fetchAlAdhanTimes(lat, lon, cityInput);
            }

            // 7. UI gÃ¼ncelle
            times = {
                Fajr:    todayVakit.Imsak,
                Sunrise: todayVakit.Gunes,
                Dhuhr:   todayVakit.Ogle,
                Asr:     todayVakit.Ikindi,
                Maghrib: todayVakit.Aksam,
                Isha:    todayVakit.Yatsi
            };

            document.getElementById('time-fajr').innerText    = times.Fajr;
            document.getElementById('time-maghrib').innerText = times.Maghrib;
            document.getElementById('hicri-display').innerText =
                `â˜ªï¸ ${todayVakit.HicriTarihUzun || ''}`;

            await fetchQiblaForCoords(lat, lon);
            localStorage.setItem('lastCity', cityInput);
            startCountdown();

        } catch (err) {
            console.error('Diyanet API hatasÄ±, AlAdhan yedek kullanÄ±lÄ±yor:', err);
            await fetchAlAdhanTimes(lat, lon, cityInput);
        }
    }

    // â”€â”€â”€ AlAdhan API (DÃ¼nya geneli) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function fetchAlAdhanTimes(lat, lon, cityInput) {
        const res  = await fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=13`);
        const data = await res.json();

        if (data.code === 200) {
            times = data.data.timings;

            document.getElementById('time-fajr').innerText    = times.Fajr;
            document.getElementById('time-maghrib').innerText = times.Maghrib;
            document.getElementById('hicri-display').innerText =
                `â˜ªï¸ ${data.data.date.hijri.day} ${data.data.date.hijri.month.en} ${data.data.date.hijri.year}`;

            await fetchQiblaForCoords(lat, lon);
            if (cityInput) localStorage.setItem('lastCity', cityInput);
            startCountdown();
        } else {
            alert('Namaz vakitleri alÄ±namadÄ±. LÃ¼tfen tekrar deneyin.');
        }
    }

    async function fetchQiblaForCoords(lat, lon) {
        try {
            const qRes = await fetch(`https://api.aladhan.com/v1/qibla/${lat}/${lon}`);
            const qData = await qRes.json();
            qiblaAngle = parseFloat(qData.data.direction.toFixed(2));
            if (document.getElementById('qibla-modal').classList.contains('open')) {
                document.getElementById('qibla-angle-display').innerText = qiblaAngle;
                updateQiblaArrow();
            }
        } catch (e) {
            console.warn('KÄ±ble hesaplanamadÄ±:', e);
        }
    }

    const TR_DAYS = ['Pazar','Pazartesi','SalÄ±','Ã‡arÅŸamba','PerÅŸembe','Cuma','Cumartesi'];
    const TR_MONTHS = ['Ocak','Åubat','Mart','Nisan','MayÄ±s','Haziran','Temmuz','AÄŸustos','EylÃ¼l','Ekim','KasÄ±m','AralÄ±k'];
    const EN_DAYS = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
    const EN_MONTHS = ['January','February','March','April','May','June','July','August','September','October','November','December'];
    const AR_DAYS = ['Ø§Ù„Ø£Ø­Ø¯','Ø§Ù„Ø§Ø«Ù†ÙŠÙ†','Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡','Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡','Ø§Ù„Ø®Ù…ÙŠØ³','Ø§Ù„Ø¬Ù…Ø¹Ø©','Ø§Ù„Ø³Ø¨Øª'];
    const AR_MONTHS = ['ÙŠÙ†Ø§ÙŠØ±','ÙØ¨Ø±Ø§ÙŠØ±','Ù…Ø§Ø±Ø³','Ø£Ø¨Ø±ÙŠÙ„','Ù…Ø§ÙŠÙˆ','ÙŠÙˆÙ†ÙŠÙˆ','ÙŠÙˆÙ„ÙŠÙˆ','Ø£ØºØ³Ø·Ø³','Ø³Ø¨ØªÙ…Ø¨Ø±','Ø£ÙƒØªÙˆØ¨Ø±','Ù†ÙˆÙÙ…Ø¨Ø±','Ø¯ÙŠØ³Ù…Ø¨Ø±'];
    const FR_DAYS = ['Dimanche','Lundi','Mardi','Mercredi','Jeudi','Vendredi','Samedi'];
    const FR_MONTHS = ['Janvier','FÃ©vrier','Mars','Avril','Mai','Juin','Juillet','AoÃ»t','Septembre','Octobre','Novembre','DÃ©cembre'];

    function getMiladiText(lang) {
        const now = new Date();
        const d = now.getDate(), y = now.getFullYear(), wd = now.getDay(), m = now.getMonth();
        if (lang === 'tr') return `ğŸ“… ${TR_DAYS[wd]}, ${d} ${TR_MONTHS[m]} ${y}`;
        if (lang === 'ar') return `ğŸ“… ${AR_DAYS[wd]}ØŒ ${d} ${AR_MONTHS[m]} ${y}`;
        if (lang === 'fr') return `ğŸ“… ${FR_DAYS[wd]} ${d} ${FR_MONTHS[m]} ${y}`;
        return `ğŸ“… ${EN_DAYS[wd]}, ${EN_MONTHS[m]} ${d}, ${y}`;
    }

    function startClockAndDate() {
        if (window.clockInt) clearInterval(window.clockInt);
        function tick() {
            const now = new Date();
            const hh = now.getHours().toString().padStart(2,'0');
            const mm = now.getMinutes().toString().padStart(2,'0');
            const ss = now.getSeconds().toString().padStart(2,'0');
            document.getElementById('real-clock').innerText = `${hh}:${mm}:${ss}`;
            document.getElementById('miladi-display').innerText = getMiladiText(currentLang);
        }
        tick();
        window.clockInt = setInterval(tick, 1000);
    }

    function startCountdown() {
        if (window.timerInt) clearInterval(window.timerInt);
        window.timerInt = setInterval(() => {
            if (!times.Fajr) return;
            const now = new Date();
            const parseT = (t) => {
                const [h, m] = t.split(':');
                let d = new Date();
                d.setHours(h, m, 0, 0);
                return d;
            };
            let f = parseT(times.Fajr), m = parseT(times.Maghrib);
            let target, label;

            if (now < f) { target = f; label = i18n[currentLang].leftSahur; }
            else if (now < m) { target = m; label = i18n[currentLang].leftIftar; }
            else { target = new Date(f); target.setDate(target.getDate() + 1); label = i18n[currentLang].leftSahur; }

            const diff = target - now;
            const h = Math.floor(diff / 3600000),
                  min = Math.floor((diff % 3600000) / 60000),
                  s = Math.floor((diff % 60000) / 1000);
            document.getElementById('timer').innerText =
                `${h.toString().padStart(2,'0')}:${min.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            document.getElementById('countdown-label').innerText = label;

            if (now > f && now < m) {
                document.getElementById('progress-bar').style.width = ((now - f) / (m - f) * 100) + "%";
            } else {
                document.getElementById('progress-bar').style.width = "0%";
            }
        }, 1000);
    }

    let compassHeading = null;
    let _absHandler   = null;
    let _relHandler   = null;
    let _absReceived  = false;
    let _noSensorTimer = null;

    function showQibla() {
        const t = i18n[currentLang];
        document.getElementById('qibla-modal').classList.add('open');
        document.getElementById('qibla-angle-display').innerText = qiblaAngle || '--';
        if (currentLat !== null) {
            document.getElementById('modal-qibla-sub').innerText =
                `${currentLat.toFixed(4)}Â°, ${currentLon.toFixed(4)}Â° â€” KÄ±ble: ${qiblaAngle}Â° K`;
        }
        renderCompassTicks();
        updateQiblaArrow();
        startCompass();
    }

    function closeQibla() {
        document.getElementById('qibla-modal').classList.remove('open');
        stopCompass();
    }

    function renderCompassTicks() {
        const ring = document.getElementById('compass-ring');
        if (ring.querySelector('.tick-marks')) return;
        const wrap = document.createElement('div');
        wrap.className = 'tick-marks';
        wrap.style.cssText = 'position:absolute;width:100%;height:100%;top:0;left:0;pointer-events:none;';
        const r = 107;
        const ns = 'http://www.w3.org/2000/svg';
        for (let i = 0; i < 360; i += 5) {
            const isMajor = i % 45 === 0, isMinor = i % 15 === 0;
            const len = isMajor ? 14 : isMinor ? 9 : 5;
            const rad = (i - 90) * Math.PI / 180;
            const x1 = 110 + r * Math.cos(rad), y1 = 110 + r * Math.sin(rad);
            const x2 = 110 + (r - len) * Math.cos(rad), y2 = 110 + (r - len) * Math.sin(rad);
            const svg = document.createElementNS(ns, 'svg');
            svg.style.cssText = 'position:absolute;top:0;left:0;width:100%;height:100%;';
            svg.setAttribute('viewBox', '0 0 220 220');
            const line = document.createElementNS(ns, 'line');
            line.setAttribute('x1', x1); line.setAttribute('y1', y1);
            line.setAttribute('x2', x2); line.setAttribute('y2', y2);
            line.setAttribute('stroke', isMajor ? '#64748b' : '#334155');
            line.setAttribute('stroke-width', isMajor ? '2' : '1');
            svg.appendChild(line); wrap.appendChild(svg);
        }
        ring.appendChild(wrap);
    }

    function smoothAngle(prev, next) {
        if (prev === null) return next;
        let diff = next - prev;
        if (diff >  180) diff -= 360;
        if (diff < -180) diff += 360;
        return ((prev + diff * 0.4) + 360) % 360;
    }

    function updateQiblaArrow() {
        const arrow  = document.getElementById('qibla-arrow');
        const ring   = document.getElementById('compass-ring');
        const northN = document.getElementById('north-needle');
        const southN = document.getElementById('south-needle');
        const stat   = document.getElementById('qibla-status-text');
        const t = i18n[currentLang];

        if (compassHeading !== null && qiblaAngle) {
            ring.style.transform   = `rotate(${-compassHeading}deg)`;
            northN.style.transform = `translateX(-50%) translateY(-100%) rotate(${compassHeading}deg)`;
            southN.style.transform = `translateX(-50%) rotate(${compassHeading}deg)`;
            const rel  = qiblaAngle - compassHeading;
            arrow.style.transform  = `translateX(-50%) translateY(-100%) rotate(${rel}deg)`;
            const norm = ((rel % 360) + 360) % 360;
            const ok   = norm < 8 || norm > 352;
            stat.className = 'qibla-status ' + (ok ? 'locked' : 'searching');
            stat.innerText = ok
                ? t.qiblaStatusLocked
                : `ğŸ§­ YÃ¶nÃ¼nÃ¼z: ${Math.round(compassHeading)}Â° â€” KÄ±ble: ${qiblaAngle}Â° K`;
        } else if (qiblaAngle) {
            arrow.style.transform = `translateX(-50%) translateY(-100%) rotate(${qiblaAngle}deg)`;
            stat.className = 'qibla-status searching';
            stat.innerText = t.qiblaStatusSearching;
        } else {
            stat.className = 'qibla-status searching';
            stat.innerText = t.qiblaStatusSearching;
        }
    }

    function processOrientationEvent(e, forceAbsolute) {
        let heading = null;
        if (typeof e.webkitCompassHeading === 'number' && !isNaN(e.webkitCompassHeading) && e.webkitCompassHeading >= 0) {
            heading = e.webkitCompassHeading;
        } else if ((forceAbsolute || e.absolute === true) && e.alpha !== null && e.alpha !== undefined) {
            heading = (360 - e.alpha + 360) % 360;
        }
        if (heading !== null) {
            compassHeading = smoothAngle(compassHeading, heading);
            updateQiblaArrow();
        }
    }

    function attachListeners() {
        _absReceived = false;
        _absHandler = (e) => {
            if (e.alpha !== null && e.alpha !== undefined) {
                _absReceived = true;
                processOrientationEvent(e, true);
            }
        };
        window.addEventListener('deviceorientationabsolute', _absHandler, true);

        _relHandler = (e) => {
            if (_absReceived) return;
            processOrientationEvent(e, false);
        };
        window.addEventListener('deviceorientation', _relHandler, true);

        _noSensorTimer = setTimeout(() => {
            if (compassHeading === null) {
                const stat = document.getElementById('qibla-status-text');
                if (stat) {
                    stat.className = 'qibla-status searching';
                    stat.innerText = i18n[currentLang].qiblaStatusNoSensor;
                }
            }
        }, 2000);
    }

    function startCompass() {
        stopCompass();
        if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
            DeviceOrientationEvent.requestPermission()
                .then(state => {
                    if (state === 'granted') attachListeners();
                    else {
                        const stat = document.getElementById('qibla-status-text');
                        stat.className = 'qibla-status searching';
                        stat.innerText = i18n[currentLang].permissionDenied;
                    }
                })
                .catch(() => {
                    const stat = document.getElementById('qibla-status-text');
                    stat.className = 'qibla-status searching';
                    stat.innerText = 'âš ï¸ Ä°zin alÄ±namadÄ±.';
                });
        } else if ('DeviceOrientationEvent' in window) {
            attachListeners();
        } else {
            const stat = document.getElementById('qibla-status-text');
            stat.className = 'qibla-status searching';
            stat.innerText = i18n[currentLang].noSupport;
            updateQiblaArrow();
        }
    }

    function stopCompass() {
        if (_absHandler)  { window.removeEventListener('deviceorientationabsolute', _absHandler, true); _absHandler = null; }
        if (_relHandler)  { window.removeEventListener('deviceorientation',         _relHandler, true); _relHandler = null; }
        if (_noSensorTimer) { clearTimeout(_noSensorTimer); _noSensorTimer = null; }
        compassHeading = null;
        _absReceived   = false;
    }

    document.getElementById('qibla-modal').addEventListener('click', function (e) {
        if (e.target === this) closeQibla();
    });

    function shareHadith() {
        const idx = new Date().getDate() % hadithList.length;
        const had = hadithList[idx];
        const hadithText = had[currentLang];
        const narratorText = had.narrator[currentLang];
        const text = `"${hadithText}"\n\n${narratorText}`;
        if (navigator.share) navigator.share({ title: 'Hadis', text: text });
        else {
            navigator.clipboard && navigator.clipboard.writeText(text);
            alert('KopyalandÄ±!');
        }
    }

    function showInstallModal() {
        document.getElementById('install-modal').classList.add('show');
    }

    function closeInstallModal() {
        document.getElementById('install-modal').classList.remove('show');
        localStorage.setItem('installPromptShown', 'true');
    }

    if (localStorage.getItem('theme') === 'dark') toggleTheme();
    setLang('tr');
    startClockAndDate();
    
    document.getElementById('install-body').innerHTML = multiLangInstallHTML;
    
    const saved = localStorage.getItem('lastCity') || "EskiÅŸehir";
    document.getElementById('city-input').value = saved;
    searchCity();

    if (!localStorage.getItem('installPromptShown')) {
        window.addEventListener('load', () => {
            setTimeout(() => {
                showInstallModal();
            }, 1200);
        });
    }
</script>
</body>
</html>